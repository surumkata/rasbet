{% load static %}
<!DOCTYPE html>

<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="{% static 'fonts.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'header.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'display.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'games-list.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'boletim.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'scrollbar.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'popup.css' %}"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
{% csrf_token %}
<title> Home Page </title>
</head>

<body>
  <div class="popup" id="no-balance-popup">
    <div class="model">
      <div>
        Saldo insuficiente
      </div>
      <div>
        <a href="/accounts/deposit/">
        <button>Depositar</div>
        </a>
        <button onclick="close_no_balance_popup()">Mais tarde</div>
      </div>
    </div>
  </div>

  <div class="popup" id="sucess-popup">
    <div class="model">
      <div>
        Aposta realizada
      </div>
      <div>
        <a href="/">
        <button>ok</div>
        </a>
      </div>
    </div>
  </div>


  {% if logged %}
    <div class="header">
      <div class="header-left">
        <div class="tab"><a class="img" href="/" ><img src="{% static 'logo.png' %}" alt="Rasbet Logo"></a></div>
        <div class="tab"><a class="active" href="/">Desporto</a></div>
        <div class="tab"><a href="/accounts/promotions">Promoções</a></div>
        <div class="tab"><a href="/accounts/profile">{{ fname }}</a></div>
        <div class="tab_balance">{{ balance | floatformat:2 }}€<a href="/accounts/deposit">+</a></div>
      </div>
      <div class="header-right">
        <div class="tab"><a href="/accounts/logout">Logout</a></div>
      </div>
    </div>
  {% else %}
  <div class="header">
    <div class="header-left">
      <div class="tab"><a class="img" href="/" ><img src="{% static 'logo.png' %}" alt="Rasbet Logo"></a></div>
      <div class="tab"><a class="active" href="/">Desporto</a></div>
      <div class="tab"><a href="/accounts/promotions">Promoções</a></div>
    </div>
    <div class="header-right">
      <div class="tab"><a href="/accounts/login">Login</a></div>
      <div class="tab"><a href="/accounts/signup">Registar</a></div>
    </div>
  </div>
  {% endif %}

  <div class="display">
    <div class="display-left" style="background-color:#aaa;">
      <form method='get' action="/game/filter">
      <h2>Favoritos</h2>
      {% for type,favorites in favorites_info.items%}
      <p>
        <a class="" data-toggle="collapse"
                href="#{{type}}" role="button"
                aria-expanded="false" aria-controls="{{type}}">
            {{type}}
        </a>
      </p>
      <div class="collapse" id="{{type}}">
        {% for favorite in favorites %}
        <div>
          <button name="{{type}}" type="submit" value="{{favorite}}" data-checked="false" >{{favorite}}</button>
        </div>
        {% endfor %}
      </div>

      {%endfor%}
      <h2>Desportos</h2>
      {% for s, countrys in sports_info.items %}
      <p>
          <a class="" data-toggle="collapse"
                  href="#{{s}}" role="button"
                  aria-expanded="false" aria-controls="{{s}}">
              {{s}}
          </a>
          {% if logged %}
          <input type="checkbox"  {%if s in favorites_info.sport %} checked {%endif%} class="" name="sport:{{s}}" onclick='update_fav(this);'>fav</input>
          {%endif%}
      </p>
      <div class="collapse" id="{{s}}">
          <div>
            <button name="sport" type="submit" value="{{s}}" data-checked="false" >Toda a oferta</button>
          </div>
          {% for country, competitions in countrys.items %}
          <p>
            <a class="" data-toggle="collapse"
                  href="#{{s}}{{country}}" role="button"
                  aria-expanded="false" aria-controls="{{s}}{{country}}">
              {{country}}
            </a>
          </p>
          <div class="collapse" id="{{s}}{{country}}">
            {% for c in competitions %}
            <div>
              <button name="competition" type="submit" value="{{c}}" data-checked="false" >{{c}}</button>
              {% if logged %}
              <input type="checkbox"  {%if c in favorites_info.competition %} checked {%endif%} class="" name="competition:{{c}}" onclick='update_fav(this);'>fav</input>
              {%endif%}
            </div>
            {% endfor %}
          </div>
          {% endfor %}
      </div>
      {% endfor %}
      </form>
      <form method='get' action="/game/filter">
        <div>
          {% if get.sport %} <input type="hidden" name="sport" value="{{get.sport}}"> {%endif%}
          {% if get.competition %}<input type="hidden" name="competition" value="{{get.competition}}">{%endif%}
          {% if get.participant %}<input type="hidden" name="participant" value="{{get.participant}}">{%endif%}
          <button name="order_by_nb" type="submit" value="True">ordenar por numero de apostas</button>
        </div>
      </form>
    </div>
    <div class="display-center">

      {% for date, games in games_info.items%}
      <p>{{date}}</p>
      {% for g in games%}
      <div class="card-event">
        <div class="event">
          <div class="event_path">
            <p><span>{{g.game.sport}} - {{g.game.country}} - {{g.game.competition}}<span></p>
          </div>
          <div class="event_info">
            <div class="home">
              <p><b>{{g.game.home}}</b></p>
            </div>
            <div class="event_date">
              <div class="datetime">
                <div class="date">
                  {{g.game.datetime|date:"d/m/Y"}}
                </div>
                <div class="hour">
                  {{g.game.datetime|date:"H:i"}}
                </div>
              </div>
            </div>
            <div class="away">
              <p><b>{{g.game.away}}</b></p>
            </div>
            <p>número de apostas: {{g.nb}}</p>
          </div>
        </div>
        <div class="market_odds">
          <div class="odds">
            <div class="odd">
              <button id="{{g.game.game_id}};home" data-checked="false" data-home="{{g.game.home}}" data-away="{{g.game.away}}" data-bet="{{g.game.home}}" data-odd="{{g.home_odd}}" onclick="button_handler(this);" >{{g.game.home}}<br><span>{{g.home_odd}}</span></button>
              <p>{{g.home_nb}}%</p>
            </div>
            <div class="odd">
              <button id="{{g.game.game_id}};draw" data-checked="false" data-home="{{g.game.home}}" data-away="{{g.game.away}}" data-bet="Draw" data-odd="{{g.draw_odd}}" onclick="button_handler(this);" >Draw<br><span>{{g.draw_odd}}</span></button>
              <p>{{g.draw_nb}}%</p>
            </div>
            <div class="odd">
              <button id="{{g.game.game_id}};away" data-checked="false" data-home="{{g.game.home}}" data-away="{{g.game.away}}" data-bet="{{g.game.away}}" data-odd="{{g.away_odd}}" onclick="button_handler(this);">{{g.game.away}}<br><span>{{g.away_odd}}</span></button>
              <p>{{g.away_nb}}%</p>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
      {% endfor %}
    </div>
    <div class="display-right">
      <div class="boletimWrapper">
          <div class="boletim">
            <div class="boletimHeader">
              <div class="title">
                <p>A minha aposta</p>
              </div>
              <div class="tabs">
                <div class="tab">
                  <button id="simplebtt" class="checked" onclick="slip_handler('simple')">Simples</button>
                </div>
                <div class="tab">
                  <button id="multibtt" class="unchecked" onclick="slip_handler('multiple')">Multipla</button>
                </div>
              </div>
            </div>
            <div id="slipbody" class="boletimContent slip"><div id="slipbodyMsg">Adiciona a tua primeira aposta!</div></div>
            <div class="boletimFooter">
              <div class="boletimRow">
                <div id="rowCimaNome" class="boletimRowItem start"><span>Montante Total</span></div>
                <div id="rowCimaValor" class="boletimRowItem end"><span>0,00€</span></div>
              </div>
              <div class="boletimRow">
                <div id="rowBaixoNome" class="boletimRowItem start"><span>Ganhos Possíveis</span></div>
                <div id="valorGanhos" class="boletimRowItem end"><span>0,00€<span></div>
              </div>
              <div class="boletimRowItem">
                <div>
                  <input class="buttonApostar" type="submit" value="Apostar" onclick="post_slip()"> </input>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="{% static 'bettingslip.js' %}"></script>
  <script src="{% static 'cookies.js' %}"></script>
 </body>
 </html>
